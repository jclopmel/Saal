var choice, resultsearch, position;
var vehiclesJson = {"vehicles":[{"name": "Stelvio", "description": "Red coloured fast vehicle", "type": "Ford"},{"name": "X5", "description": "Green coloured slow vehicle", "type": "Audi"},{"name": "Picasso", "description": "Yellow coloured slow vehicle", "type": "Peugeot"},{"name": "Stelvio", "description": "Black coloured small vehicle", "type": "Peugeot"},{"name": "Vanquish", "description": "White coloured fast vehicle", "type": "Aston Martin"},{"name": "X5", "description": "Green coloured slow vehicle", "type": "Aston Martin"},{"name": "Vanquish", "description": "Red coloured fast vehicle", "type": "Audi"},{"name": "Logan", "description": "Black coloured small vehicle", "type": "BMW"},{"name": "Flying Spur", "description": "Black coloured small vehicle", "type": "Aston Martin"},{"name": "Lexus", "description": "Red coloured fast vehicle", "type": "Ford"},{"name": "A4", "description": "Red coloured fast vehicle", "type": "Ford"},{"name": "Stelvio", "description": "Red coloured fast vehicle", "type": "Ford"},{"name": "Logan", "description": "Silvered coloured fast vehicle", "type": "Audi"},{"name": "Orlando", "description": "Black coloured slow vehicle", "type": "Peugeot"}]};
var vehicles = vehiclesJson.vehicles; 
               /*-----------------------------Json Generated by the next code-------------------------*/

/*var autos = function (name,description,type){
	this.name = name;
	this.description = description;
	this.type = type;
}
var names = ["124 Spider","Stelvio","Vanquish","A4","Flying Spur","X5","Orlando","Camaro","Picasso","Logan"];
var descriptions = ["Red coloured fast vehicle","Green coloured slow vehicle","Blue coloured big vehicle","Black coloured small vehicle","White coloured fast vehicle","Yellow coloured slow vehicle"];
var types = ["BMW","Audi","Peugeot","Renault","Aston Martin","Lexus","Ford"];

function randomValue(data){
	var random = Math.round(Math.random() * (10 - 0) + 0);
	return data[random];
}

for (var i = 0; i<9; i++) {
	var car = new autos (randomValue(names),randomValue(descriptions),randomValue(types));
	autoJson.vehicles.push(car);
}*/

$("#mySearch").click(function(){
	showResults();
})

function showResults(){														//Display the suggestion and dissapear after 3 seconds
	$("#resultsBox").empty();
	for(var i=0;i<vehicles.length;i++){
		$(".suggest").append("<li class='list-group-item list-group-item-action'>"+vehicles[i].name+" is "+vehicles[i].type+"</li>");
	}
	setTimeout(function(){
		$("li").remove();
	}, 3000); 
}

$.ajax({
    
	url: "http://localhost:3000/prueba",
	method: "put",
	dataType: "json",
	data: {name: "MI COCHE NUEVO", description: "ESTE ES MI COCHE NUEVO", type: "car"},
    success: function(data){
		console.log("exito", data);
	}
});



function selectedData(){													//Show the name of the searched data
	$("#resultsBox").empty();
	var data = $("#mySearch").val();
	for(var i=0;i<vehicles.length;i++){
		if(data == vehicles[i].name || data == vehicles[i].type){
			$("#resultsBox").append("<a class='list-group-item list-group-item-action' onclick='infoShow(this.innerText)'>"+vehicles[i].name+"</a>");
		}
	}
}
function infoShow(data){													//Show all the informacion about the object
	choice = data;
	choose();
	objectTarget();
}

function choose(){																//Show the selected option and save array position
	for(var i=0;i<vehicles.length;i++){
		if(choice==vehicles[i].name){
			position 	= i;
		}
	}
}

function objectTarget(){														//Display the results in objectBox
	$("#objectBox").empty();
	$("#objectBox").append("<a class='list-group-item list-group-item-action'>Name of the vehicle: "+vehicles[position].name+"</a>");
	$("#objectBox").append("<a class='list-group-item list-group-item-action'>Characteristics of the vehicle: "+vehicles[position].description+"</a>");
	$("#objectBox").append("<a class='list-group-item list-group-item-action'>Type: "+vehicles[position].type+"</a>");
}

function deleteThis(){															//Delete the displayed object
	$("#objectBox").empty();
	vehicles.splice(position,1);
	showResults();
}

function openForm(data){														//Display the add or modify Forms
	$("#addModifyForm").empty();
	$("#addModifyForm").append('<input id="nameholder" class="form-control" type="text" placeholder="Name">');
	$("#addModifyForm").append('<input id="descriptionholder" class="form-control" type="text" placeholder="Description">');
	$("#addModifyForm").append('<input id="typeholder" class="form-control" type="text" placeholder="Type">');

	if (data.innerText == "Modify this vehicle"){
		$("#addModifyForm").append('<button class="btn btn-primary" onclick="modifyThis()">Modify</button>');
	}else{
		$("#addModifyForm").append('<button id="addButton" class="btn btn-primary" onclick="addThis()">Add</button>');
	}
}

function modifyThis(){															//Empty objectBox conditional and object modify
	if($("#objectBox").children().length != 0){
		var dataName 		= document.getElementById("nameholder").value;
		var dataDescription = document.getElementById("descriptionholder").value;
		var datatype 		= document.getElementById("typeholder").value;

		vehicles[position].name = dataName;
		vehicles[position].description = dataDescription;
		vehicles[position].type = datatype;

		showResults();

	}else{
		alert("An object must be selected");
	}
}

function addThis(){																	//Add a new Object to JSON

	var newData = {
		"name":$("#nameholder").val(),
		"description":$("#descriptionholder").val(),
		"type":$("#typeholder").val()
	}
	vehicles.push(newData);
	showResults();
	alert("New object "+newData.name+" added");
}